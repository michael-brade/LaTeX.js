<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Extending LaTeX.js | LaTeX.js</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAABJScL/SUnC/0lJwv8AAAAAAAAAAElJwv9JScL/SUnC/wAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAAAAAABJScL/SUnC/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAElJwv9JScL/AAAAAgAAAAUAAAADAAAAAAAAAAAAAAAASUnC/0lJwv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABJScL/SUnC/wAAAAIAAAAIAAAABAAAAAAAAAAAAAAAAElJwv9JScL/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASUnC/0lJwv8AAAACAAAACgAAAAYAAAAAAAAAAAAAAABJScL/SUnC/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAElJwv9JScL/AAAAAgAAAAsAAAAIAAAAAAAAAAAAAAAASUnC/0lJwv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABJScL/SUnC/wAAAAMAAAAJAAAACAAAAABJScL/SUnC/0lJwv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAElJwv9JScL/SUnC/wAAAAgAAAAAAAAAAAAAAABJScL/SUnC/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAElJwv9JScL/AAAAAQAAAAQAAAAHAAAAAAAAAAAAAAAASUnC/0lJwv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABJScL/SUnC/wAAAAIAAAAEAAAABQAAAAAAAAAAAAAAAElJwv9JScL/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASUnC/0lJwv8AAAABAAAABAAAAAMAAAAAAAAAAAAAAABJScL/SUnC/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAElJwv9JScL/AAAAAAAAAAMAAAACAAAAAAAAAAAAAAAASUnC/0lJwv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABJScL/SUnC/wAAAAEAAAACAAAAAAAAAAEAAAAAAAAAAAAAAABJScL/SUnC/0lJwv8AAAAAAAAAAElJwv9JScL/SUnC/wAAAAAAAAABAAAAAAAAAAAAAAAYAAAAFwAAABYAAAATAAAAEQAAAA0AAAALAAAACQAAAAcAAAADAAAAAwAAAAMAAAABAAAAAAAAAAAAAAAA8BMAAP/5AADxiAAA5+AAAOfgAADn4AAA5+AAAOfgAACP8AAA5+AAAOfgAADn4AAA5+QAAOfhAABxiwAAAAcAAA==" type="image/x-icon">
    <meta name="description" content="JavaScript LaTeX to HTML5 translator">
    <link rel="preload" href="/assets/css/0.styles.7e04b48a.css" as="style"><link rel="preload" href="/assets/js/app.f392a111.js" as="script"><link rel="preload" href="/assets/js/3.776ae208.js" as="script"><link rel="preload" href="/assets/js/4.280ded28.js" as="script"><link rel="preload" href="/assets/js/7.c3cf5d67.js" as="script"><link rel="preload" href="/assets/js/14.ea897eca.js" as="script"><link rel="preload" href="/assets/js/9.bb332ccd.js" as="script"><link rel="prefetch" href="/assets/js/1.5cf01570.js"><link rel="prefetch" href="/assets/js/10.51c2fff7.js"><link rel="prefetch" href="/assets/js/11.ddb5032b.js"><link rel="prefetch" href="/assets/js/12.1e1aa1bc.js"><link rel="prefetch" href="/assets/js/13.3a53173e.js"><link rel="prefetch" href="/assets/js/15.1c83203c.js"><link rel="prefetch" href="/assets/js/16.0e1e2fe3.js"><link rel="prefetch" href="/assets/js/17.7ba791c6.js"><link rel="prefetch" href="/assets/js/18.eb1fe1d7.js"><link rel="prefetch" href="/assets/js/19.d5e62f04.js"><link rel="prefetch" href="/assets/js/20.5dd16729.js"><link rel="prefetch" href="/assets/js/21.b3970b87.js"><link rel="prefetch" href="/assets/js/5.065061eb.js"><link rel="prefetch" href="/assets/js/6.581b1355.js"><link rel="prefetch" href="/assets/js/8.fb3c42d3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7e04b48a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/latexjs.png" alt="LaTeX.js" class="logo"> <span class="latex" data-v-4826c06c>L<span data-v-4826c06c>a</span>T<span data-v-4826c06c>e</span>X</span>.js
  </a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/usage.html" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/playground.html" class="nav-link">
  Playground
</a></div><div class="nav-item"><a href="https://github.com/michael-brade/LaTeX.js/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ChangeLog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/michael-brade/LaTeX.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/usage.html" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/playground.html" class="nav-link">
  Playground
</a></div><div class="nav-item"><a href="https://github.com/michael-brade/LaTeX.js/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ChangeLog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/michael-brade/LaTeX.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Home</a></li><li><a href="/usage.html" class="sidebar-link">Usage</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/usage.html#cli" class="sidebar-link">CLI</a></li><li class="sidebar-sub-header"><a href="/usage.html#webcomponent" class="sidebar-link">WebComponent</a></li><li class="sidebar-sub-header"><a href="/usage.html#library" class="sidebar-link">Library</a></li><li class="sidebar-sub-header"><a href="/usage.html#in-the-browser" class="sidebar-link">In the Browser</a></li></ul></li><li><a href="/api.html" class="sidebar-link">API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api.html#parser" class="sidebar-link">Parser</a></li><li class="sidebar-sub-header"><a href="/api.html#ast" class="sidebar-link">AST</a></li><li class="sidebar-sub-header"><a href="/api.html#class-generator" class="sidebar-link">class: Generator</a></li><li class="sidebar-sub-header"><a href="/api.html#class-htmlgenerator" class="sidebar-link">class: HtmlGenerator</a></li></ul></li><li><a href="/extending.html" aria-current="page" class="active sidebar-link">Extending LaTeX.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/extending.html#architecture" class="sidebar-link">Architecture</a></li><li class="sidebar-sub-header"><a href="/extending.html#directory-structure" class="sidebar-link">Directory Structure</a></li><li class="sidebar-sub-header"><a href="/extending.html#tests" class="sidebar-link">Tests</a></li><li class="sidebar-sub-header"><a href="/extending.html#documentation-and-playground" class="sidebar-link">Documentation and Playground</a></li><li class="sidebar-sub-header"><a href="/extending.html#definition-of-custom-macros" class="sidebar-link">Definition of Custom Macros</a></li></ul></li><li><a href="/limitations.html" class="sidebar-link">Limitations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/limitations.html#due-to-html-and-css" class="sidebar-link">... due to HTML and CSS</a></li><li class="sidebar-sub-header"><a href="/limitations.html#when-parsing-tex-as-a-context-free-grammar" class="sidebar-link">... when parsing TeX as a context-free grammar</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="extending-js"><a href="#extending-js" class="header-anchor">#</a> Extending <span class="latex" data-v-8d3c2e68>L<span data-v-8d3c2e68>a</span>T<span data-v-8d3c2e68>e</span>X</span>.js</h1> <p>To work on <span class="latex" data-v-8d3c2e68>L<span data-v-8d3c2e68>a</span>T<span data-v-8d3c2e68>e</span>X</span>.js itself and to extend it, first clone this repository.</p> <h2 id="architecture"><a href="#architecture" class="header-anchor">#</a> Architecture</h2> <p>The generated PEG parser parses the <span class="latex" data-v-8d3c2e68>L<span data-v-8d3c2e68>a</span>T<span data-v-8d3c2e68>e</span>X</span> code. While doing so, it calls appropriate generator functions.
The generator then uses the Macros class to execute the macros that the parser encounters.</p> <p>Both, the parser and the macros create the resulting HTML DOM tree by calling the HtmlGenerator functions.</p> <p>The generator also holds the stack, the lengths, counters, fonts, references, etc. It provides some of
TeX's primitives and basic functionality, so to speak.</p> <h2 id="directory-structure"><a href="#directory-structure" class="header-anchor">#</a> Directory Structure</h2> <p>General structure:</p> <ul><li><code>src</code>: all the <span class="latex" data-v-8d3c2e68>L<span data-v-8d3c2e68>a</span>T<span data-v-8d3c2e68>e</span>X</span>.js sources</li> <li><code>bin</code>: the compiled CLI</li> <li><code>dist</code>: the compiled and minified source</li> <li><code>docs</code>: the webpage and (compiled) playground</li> <li><code>test</code>: unit tests and test driver</li></ul> <p>Files and classes needed to translate <span class="latex" data-v-8d3c2e68>L<span data-v-8d3c2e68>a</span>T<span data-v-8d3c2e68>e</span>X</span> documents to HTML documents:</p> <ul><li><p>the parser: <code>src/latex-parser.pegjs</code></p></li> <li><p>the generator: <code>src/html-generator.ls</code></p></li> <li><p>macros and documentclasses: <code>src/macros.ls</code>, <code>src/symbols.ls</code>, <code>src/documentclasses/*.ls</code></p></li> <li><p>packages: <code>src/packages/*.ls</code></p></li> <li><p>the CLI: <code>src/latex.js.ls</code></p></li> <li><p>the webcomponent: <code>src/latex.component.js</code></p></li> <li><p>the library API: <code>src/index.js</code></p></li></ul> <p>Files needed to display the generated HTML document:</p> <ul><li><code>src/js/</code> (and thus <code>dist/js/</code>): JavaScript that is needed by the resulting HTML document</li> <li><code>src/css/</code> (and thus <code>dist/js/</code>): CSS needed by translated HTML document</li> <li><code>src/fonts/</code> (and thus <code>dist/fonts</code>): fonts included by the translated HTML document</li></ul> <h2 id="tests"><a href="#tests" class="header-anchor">#</a> Tests</h2> <p>To build it and run the tests, clone this repository and execute:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span>
<span class="token function">npm</span> run build   <span class="token comment"># or devbuild</span>
<span class="token function">npm</span> <span class="token builtin class-name">test</span>
</code></pre></div><p>To verify the screenshots (the CSS tests), ImageMagick needs to be installed. Screenshots are taken
with Chromium using <code>puppeteer</code>.</p> <h2 id="documentation-and-playground"><a href="#documentation-and-playground" class="header-anchor">#</a> Documentation and Playground</h2> <p>To build the website, including the playground, execute:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> run docs
</code></pre></div><h2 id="definition-of-custom-macros"><a href="#definition-of-custom-macros" class="header-anchor">#</a> Definition of Custom Macros</h2> <p>To define your own <span class="latex" data-v-8d3c2e68>L<span data-v-8d3c2e68>a</span>T<span data-v-8d3c2e68>e</span>X</span> macros in JavaScript and extend <span class="latex" data-v-8d3c2e68>L<span data-v-8d3c2e68>a</span>T<span data-v-8d3c2e68>e</span>X</span>.js, you have to create a class that contains these macros
and pass it to the <code>HtmlGenerator</code> constructor in the <code>options</code> object as <code>CustomMacros</code> property. For instance:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> generator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">latexjs<span class="token punctuation">.</span>HtmlGenerator</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  CustomMacros<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> args      <span class="token operator">=</span> CustomMacros<span class="token punctuation">.</span>args <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        prototype <span class="token operator">=</span> <span class="token class-name">CustomMacros</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">CustomMacros</span><span class="token punctuation">(</span><span class="token parameter">generator</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>g <span class="token operator">=</span> generator<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    args<span class="token punctuation">[</span><span class="token string">'bf'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'HV'</span><span class="token punctuation">]</span>
    prototype<span class="token punctuation">[</span><span class="token string">'bf'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>g<span class="token punctuation">.</span><span class="token function">setFontWeight</span><span class="token punctuation">(</span><span class="token string">'bf'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> CustomMacros<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>to define the <span class="latex" data-v-8d3c2e68>L<span data-v-8d3c2e68>a</span>T<span data-v-8d3c2e68>e</span>X</span>2.09 macro <code>\bf</code>.</p> <p>If you are going to define custom macros in an external file and you want to use that with the CLI, you will have to
name the file just like the class, or you will have to default export it.</p> <h3 id="macro-arguments"><a href="#macro-arguments" class="header-anchor">#</a> Macro Arguments</h3> <p><code>CustomMacros.args</code> above is a &lt;<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" title="Map" target="_blank" rel="noopener noreferrer">Map<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&lt;<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" title="String" target="_blank" rel="noopener noreferrer">string<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="Array" target="_blank" rel="noopener noreferrer">Array<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&lt;<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" title="String" target="_blank" rel="noopener noreferrer">string<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>&gt;&gt;&gt;, mapping the macro name to the type and arguments of
the macro. If a macro doesn't take arguments and is a horizontal-mode macro, <code>args</code> can be left undefined for it.</p> <p>The first array entry of <code>args[&lt;macro name&gt;]</code> declares the macro type:</p> <table><thead><tr><th>type</th> <th>meaning</th></tr></thead> <tbody><tr><td><code>H</code></td> <td>horizontal-mode macro</td></tr> <tr><td><code>V</code></td> <td>vertical-mode macro - ends the current paragraph</td></tr> <tr><td><code>HV</code></td> <td>horizontal-vertical-mode macro: must return nothing, i.e., doesn't create output</td></tr> <tr><td><code>P</code></td> <td>only in preamble</td></tr> <tr><td><code>X</code></td> <td>special entry, may be used multiple times; execute action (macro body) already now with whatever arguments have been parsed so far; this is needed when things should be done before the next arguments are parsed - no value should be returned by the macro in this case, for it will just be ignored</td></tr></tbody></table> <p>The rest of the list (array entries) declares the arguments:</p> <table><thead><tr><th>arg</th> <th>delimiters</th> <th>meaning</th> <th>content</th> <th>output</th></tr></thead> <tbody><tr><td><code>s</code></td> <td></td> <td>optional star</td> <td></td> <td></td></tr> <tr><td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td><code>g</code></td> <td>{ }</td> <td><span class="latex" data-v-8d3c2e68>L<span data-v-8d3c2e68>a</span>T<span data-v-8d3c2e68>e</span>X</span> code group (possibly long)</td> <td>TeX allows <code>\endgraf</code>, but not <code>\par</code>... so allow <code>\par</code> as well</td> <td></td></tr> <tr><td><code>hg</code></td> <td>{ }</td> <td>restricted horizontal mode material</td> <td></td> <td></td></tr> <tr><td><code>o?</code></td> <td>[ ]</td> <td>optional arg</td> <td><span class="latex" data-v-8d3c2e68>L<span data-v-8d3c2e68>a</span>T<span data-v-8d3c2e68>e</span>X</span> code</td> <td></td></tr> <tr><td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td><code>h</code></td> <td></td> <td>restricted horizontal mode material</td> <td></td> <td></td></tr> <tr><td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td><code>i</code></td> <td>{ }</td> <td>id</td> <td>letters only</td> <td></td></tr> <tr><td><code>i?</code></td> <td>[ ]</td> <td>optional id</td> <td>letters only</td> <td></td></tr> <tr><td><code>k</code></td> <td>{ }</td> <td>key</td> <td>anything but = and ,</td> <td></td></tr> <tr><td><code>k?</code></td> <td>[ ]</td> <td>optional key</td> <td>anything but = and ,</td> <td></td></tr> <tr><td><code>csv</code></td> <td>{ }</td> <td>comma-separated values</td> <td></td> <td></td></tr> <tr><td><code>csv?</code></td> <td>[ ]</td> <td>optional comma-separated values</td> <td></td> <td></td></tr> <tr><td><code>kv?</code></td> <td>[ ]</td> <td>optional key-value list</td> <td></td> <td></td></tr> <tr><td><code>u</code></td> <td>{ }</td> <td>url</td> <td>a URL as specified by RFC3986</td> <td></td></tr> <tr><td><code>c</code></td> <td>{ }</td> <td>color specification</td> <td><em>name</em> or <em>float</em> or <em>float,float,float</em></td> <td></td></tr> <tr><td><code>m</code></td> <td>{ }</td> <td>macro</td> <td><code>\macro</code></td> <td></td></tr> <tr><td><code>l</code></td> <td>{ }</td> <td>length</td> <td></td> <td></td></tr> <tr><td><code>lg?</code></td> <td>{ }</td> <td>optional length group</td> <td></td> <td></td></tr> <tr><td><code>l?</code></td> <td>[ ]</td> <td>optional length</td> <td></td> <td></td></tr> <tr><td><code>cl</code></td> <td>{ }</td> <td>coordinate/length</td> <td><code>&lt;float&gt;</code> or TeX length</td> <td></td></tr> <tr><td><code>cl?</code></td> <td>[ ]</td> <td>optional coordinate/length</td> <td></td> <td></td></tr> <tr><td><code>n</code></td> <td>{ }</td> <td>num expression</td> <td></td> <td></td></tr> <tr><td><code>n?</code></td> <td>[ ]</td> <td>optional num expression</td> <td></td> <td></td></tr> <tr><td><code>f</code></td> <td>{ }</td> <td>float expression</td> <td></td> <td></td></tr> <tr><td><code>v</code></td> <td>( )</td> <td>vector, a pair of coordinates</td> <td>(float/length, float/length)</td> <td></td></tr> <tr><td><code>v?</code></td> <td></td> <td>optional vector</td> <td></td> <td></td></tr> <tr><td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td><code>is</code></td> <td></td> <td>ignore (following) spaces</td> <td></td> <td></td></tr></tbody></table> <p>So, in the following example, the macro <code>\title</code> would be a horizontal-vertical-mode macro that takes one mandatory
TeX-group argument:</p> <div class="language-js extra-class"><pre class="language-js"><code>args<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'HV'</span><span class="token punctuation">,</span> <span class="token string">'g'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>Macros with types <code>H</code> or <code>V</code> have to return an array.</p> <p>Environments take the return value of the corresponding macro and add their content as child/children to it.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/api.html" class="prev">
        API
      </a></span> <span class="next"><a href="/limitations.html">
        Limitations
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f392a111.js" defer></script><script src="/assets/js/3.776ae208.js" defer></script><script src="/assets/js/4.280ded28.js" defer></script><script src="/assets/js/7.c3cf5d67.js" defer></script><script src="/assets/js/14.ea897eca.js" defer></script><script src="/assets/js/9.bb332ccd.js" defer></script>
  </body>
</html>
